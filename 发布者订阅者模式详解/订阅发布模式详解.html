<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘å¸ƒ-è®¢é˜…</title>
</head>
<body>
    
</body>
<script>
function EventEmitter() {}
/* 
    è®¢é˜…æ”¶é›†å™¨ - å‘å¸ƒæ¶ˆæ¯ä¹‹åè¦å¹²çš„çš„äº‹
    1.onçš„æ—¶å€™äº‹ä»¶typeç±»å‹çš„äº‹ä»¶æ”¾è¿›æ•°ç»„é‡Œ
*/
EventEmitter.prototype.on = function(type, fn) {
    if(!this["aEvent-" + type]) {
        this["aEvent-" + type] = []
    }
    var a = this["aEvent-"+type];
    for(var i = 0; i < a.length; i++) {
        if(a[i] === fn) return;
    }
    a.push(fn);
}

/* 
    å‘å¸ƒæ¶ˆæ¯ - é€šçŸ¥è®¢é˜…è€…ä»¬
    1.å‘Šè¯‰æ”¶é›†å™¨ä»¬okäº†ï¼Œé€šçŸ¥è®¢é˜…è€…ä»¬å¯ä»¥å¹²è‡ªå·±çš„äº‹æƒ…äº†
*/
EventEmitter.prototype.fire = function(e, systemEvent) {
    var a = this['aEvent-' + e.type];
    console.info(`%cæˆ‘æˆåŠŸäº†ï¼%c  ${e.message}ğŸ˜ƒ^_^!`,'color:#f80;background:#000;padding:2px;', 'color: #2dab00;');
    if(a) {
        for(var i = 0; i < a.length; i++) {
            if(typeof a[i] === 'function') {
                a[i].call(this, e, systemEvent);
            } else {
                a.splice(i, 1);
                i--;
            }
        }
    }
}
/* 
    æ¥è§¦çº¦å®š
    1.æ—¢ç„¶èƒ½è®¢é˜…ï¼Œå°±å¯ä»¥è§£é™¤è®¢é˜…
 */
EventEmitter.prototype.off = function(type, fn) {
    var a = this['aEvent-' + type];
    if(a) {
        for (var i = 0; i < a.length; i++) {
            if(a[i] === fn) {
                a[i] = null;
                return;
            }
        }
    }
}

/* 
    å®šä¹‰ä¸€ä¸ªè€ƒé©¾ç…§çš„åŠŸèƒ½
*/
function Driver() {}
Driver.prototype = new EventEmitter;

Driver.prototype.license = function() {
    var _this = this;
    console.info(`%cè€ƒé©¾ç…§äº†ï¼%c  æˆ‘å‡†å¤‡å¥½è€ƒé©¾ç…§å»äº†ï¼Œä½ ä»¬æ…¢æ…¢åŠ ç­å§ğŸ˜ƒ^_^!`,'color:#f80;background:#000;padding:2px;', 'color: #2dab00;');
    var dream = {
        type: 'license', message: 'æˆ‘ç»ˆäºæœ‰é©¾ç…§äº†ï¼'
    };
    // é€šçŸ¥è®¢é˜…è€…
    _this.fire(dream);
}

/* 
    ä¸¾ä¸ªä¾‹å­ï¼š
    ä½œè€…æƒ³å¼€è½¦ - 1.å¸¦å®¶äººå»å…œé£ï¼Œ2.çº¦æœ‹å‹å»è¶Šé‡ï¼Œ3.***
*/
function joyDriver() {
    console.info(`%cæœ‰é©¾ç…§äº†ï¼%c  æˆ‘å¸¦å®¶äººå…œé£å»äº†ï¼Œä½ ä»¬æ…¢æ…¢åŠ ç­å§ğŸ˜ƒ^_^!`,'color:#ff0; background:#000; padding:2px;', 'color: #2dabff;');
}

function overlandDriver() {
    console.info(`%cæœ‰é©¾ç…§äº†ï¼%c  æˆ‘çº¦æœ‹å‹å»è¶Šé‡äº†ï¼Œä½ ä»¬æ…¢æ…¢åŠ ç­å§ğŸ˜ƒ^_^!`,'color:#ff0;background:#000;padding:2px;', 'color: #2dabff;');
}

function joyInCar() {
    console.info(`%cæœ‰é©¾ç…§äº†ï¼%c  æˆ‘è¦äº«å—æˆ‘çš„é©¾é©¶ä¹è¶£ï¼Œä½ ä»¬æ…¢æ…¢åŠ ç­å§ğŸ˜ƒ^_^!`,'color:#ff0;background:#000;padding:2px;', 'color: transparent;text-shadow:0px 0px 5px #000;');
}

/* 
    1.æ–°å»º driverçš„å®ä¾‹
    2.æŠŠé©¾ç…§æ‹¿åˆ°æ‰‹ä»¥åæƒ³è¦å¹²çš„äº‹æƒ…ç»‘å®šonåˆ°äº‹ä»¶æ”¶é›†å™¨é‡Œ 
*/
var driver = new Driver();
driver.on('license', joyDriver);
driver.on('license', overlandDriver);
driver.on('license', joyInCar);

/* è€ƒåˆ°é©¾ç…§ - å°±å·®è¿™ä¸€å“†å—¦äº†ï¼ */
driver.license();

</script>
</html>